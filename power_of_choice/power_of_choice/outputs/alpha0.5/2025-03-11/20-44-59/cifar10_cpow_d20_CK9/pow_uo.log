[2025-03-11 20:44:59,977][flwr][INFO] - Starting Flower simulation, config: ServerConfig(num_rounds=20, round_timeout=None)
[2025-03-11 20:45:01,180][flwr][INFO] - Flower VCE: Ray initialized with resources: {'CPU': 8.0, 'object_store_memory': 2147483648.0, 'memory': 16448295732.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0}
[2025-03-11 20:45:01,180][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 0.5, 'num_gpus': 0}
[2025-03-11 20:45:01,185][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 16 actors
[2025-03-11 20:45:01,186][flwr][INFO] - Initializing global parameters
[2025-03-11 20:45:01,186][flwr][INFO] - Requesting initial parameters from one random client
[2025-03-11 20:45:06,360][flwr][INFO] - Received initial parameters from one random client
[2025-03-11 20:45:06,360][flwr][INFO] - Evaluating initial parameters
[2025-03-11 20:45:07,581][flwr][INFO] - initial parameters (loss, other metrics): 2.3038480281829834, {'accuracy': 0.10000000149011612}
[2025-03-11 20:45:07,581][flwr][INFO] - FL starting
[2025-03-11 20:45:10,316][flwr][INFO] - Server 1: selected clients
                ['3', '9', '4', '5', '6', '2', '7', '1', '0', '8'] for first phase evaluation.
[2025-03-11 20:45:10,316][flwr][DEBUG] - evaluate_first_phase 1: strategy sampled 10 clients (out of 10)
[2025-03-11 20:45:10,733][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:45:10,735][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:45:12,203][flwr][DEBUG] - evaluate_first_phase of round 1 received 9 results and 1 failures
[2025-03-11 20:45:12,203][flwr][INFO] - Server 1: about to sample 9 clients
[2025-03-11 20:45:12,203][flwr][INFO] - Round 1: selected clients
            ['9', '5', '2', '3', '1', '7', '4', '0', '8'] for fit.
[2025-03-11 20:45:12,203][flwr][DEBUG] - fit_round 1: strategy sampled 9 clients (out of 10)
[2025-03-11 20:45:33,989][flwr][DEBUG] - fit_round 1 received 9 results and 0 failures
[2025-03-11 20:45:35,061][flwr][INFO] - fit progress: (1, 2.3129842281341553, {'accuracy': 0.10000000149011612}, 27.479831999982707)
[2025-03-11 20:45:35,061][flwr][DEBUG] - evaluate_round 1: strategy sampled 9 clients (out of 10)
[2025-03-11 20:45:36,906][flwr][DEBUG] - evaluate_round 1 received 9 results and 0 failures
[2025-03-11 20:45:36,906][flwr][WARNING] - No evaluate_metrics_aggregation_fn provided
[2025-03-11 20:45:39,728][flwr][INFO] - Server 2: selected clients
                ['3', '5', '1', '7', '0', '2', '9', '4', '8', '6'] for first phase evaluation.
[2025-03-11 20:45:39,728][flwr][DEBUG] - evaluate_first_phase 2: strategy sampled 10 clients (out of 10)
[2025-03-11 20:45:39,999][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:45:40,001][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:45:41,499][flwr][DEBUG] - evaluate_first_phase of round 2 received 9 results and 1 failures
[2025-03-11 20:45:41,500][flwr][INFO] - Server 2: about to sample 9 clients
[2025-03-11 20:45:41,500][flwr][INFO] - Round 2: selected clients
            ['4', '5', '2', '8', '3', '1', '9', '0', '7'] for fit.
[2025-03-11 20:45:41,500][flwr][DEBUG] - fit_round 2: strategy sampled 9 clients (out of 10)
[2025-03-11 20:46:03,423][flwr][DEBUG] - fit_round 2 received 9 results and 0 failures
[2025-03-11 20:46:04,473][flwr][INFO] - fit progress: (2, 2.303515911102295, {'accuracy': 0.10830000042915344}, 56.89280379097909)
[2025-03-11 20:46:04,474][flwr][DEBUG] - evaluate_round 2: strategy sampled 9 clients (out of 10)
[2025-03-11 20:46:06,354][flwr][DEBUG] - evaluate_round 2 received 9 results and 0 failures
[2025-03-11 20:46:09,102][flwr][INFO] - Server 3: selected clients
                ['2', '4', '7', '6', '9', '5', '3', '1', '8', '0'] for first phase evaluation.
[2025-03-11 20:46:09,102][flwr][DEBUG] - evaluate_first_phase 3: strategy sampled 10 clients (out of 10)
[2025-03-11 20:46:09,250][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28744, ip=127.0.0.1, actor_id=0c6c2af99879921d3194783201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x14147caf0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28744, ip=127.0.0.1, actor_id=0c6c2af99879921d3194783201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x14147caf0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:46:09,252][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28744, ip=127.0.0.1, actor_id=0c6c2af99879921d3194783201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x14147caf0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28744, ip=127.0.0.1, actor_id=0c6c2af99879921d3194783201000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x14147caf0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:46:10,874][flwr][DEBUG] - evaluate_first_phase of round 3 received 9 results and 1 failures
[2025-03-11 20:46:10,874][flwr][INFO] - Server 3: about to sample 9 clients
[2025-03-11 20:46:10,874][flwr][INFO] - Round 3: selected clients
            ['8', '2', '7', '1', '9', '3', '0', '5', '4'] for fit.
[2025-03-11 20:46:10,874][flwr][DEBUG] - fit_round 3: strategy sampled 9 clients (out of 10)
[2025-03-11 20:46:32,579][flwr][DEBUG] - fit_round 3 received 9 results and 0 failures
[2025-03-11 20:46:33,677][flwr][INFO] - fit progress: (3, 2.200575351715088, {'accuracy': 0.1680999994277954}, 86.09664566605352)
[2025-03-11 20:46:33,677][flwr][DEBUG] - evaluate_round 3: strategy sampled 9 clients (out of 10)
[2025-03-11 20:46:35,577][flwr][DEBUG] - evaluate_round 3 received 9 results and 0 failures
[2025-03-11 20:46:38,300][flwr][INFO] - Server 4: selected clients
                ['6', '4', '2', '5', '7', '0', '3', '9', '8', '1'] for first phase evaluation.
[2025-03-11 20:46:38,300][flwr][DEBUG] - evaluate_first_phase 4: strategy sampled 10 clients (out of 10)
[2025-03-11 20:46:38,429][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:46:38,432][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:46:40,009][flwr][DEBUG] - evaluate_first_phase of round 4 received 9 results and 1 failures
[2025-03-11 20:46:40,009][flwr][INFO] - Server 4: about to sample 9 clients
[2025-03-11 20:46:40,009][flwr][INFO] - Round 4: selected clients
            ['0', '3', '8', '9', '1', '5', '7', '4', '2'] for fit.
[2025-03-11 20:46:40,010][flwr][DEBUG] - fit_round 4: strategy sampled 9 clients (out of 10)
[2025-03-11 20:47:01,957][flwr][DEBUG] - fit_round 4 received 9 results and 0 failures
[2025-03-11 20:47:03,002][flwr][INFO] - fit progress: (4, 2.020131826400757, {'accuracy': 0.2386000007390976}, 115.42170241603162)
[2025-03-11 20:47:03,002][flwr][DEBUG] - evaluate_round 4: strategy sampled 9 clients (out of 10)
[2025-03-11 20:47:04,855][flwr][DEBUG] - evaluate_round 4 received 9 results and 0 failures
[2025-03-11 20:47:07,585][flwr][INFO] - Server 5: selected clients
                ['7', '8', '2', '0', '9', '4', '1', '5', '3', '6'] for first phase evaluation.
[2025-03-11 20:47:07,585][flwr][DEBUG] - evaluate_first_phase 5: strategy sampled 10 clients (out of 10)
[2025-03-11 20:47:07,908][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:47:07,912][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28742, ip=127.0.0.1, actor_id=cd0f40f59118bfbfc2f8b71d01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161f40b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:47:09,352][flwr][DEBUG] - evaluate_first_phase of round 5 received 9 results and 1 failures
[2025-03-11 20:47:09,352][flwr][INFO] - Server 5: about to sample 9 clients
[2025-03-11 20:47:09,352][flwr][INFO] - Round 5: selected clients
            ['8', '4', '1', '0', '2', '7', '5', '3', '9'] for fit.
[2025-03-11 20:47:09,352][flwr][DEBUG] - fit_round 5: strategy sampled 9 clients (out of 10)
[2025-03-11 20:47:31,253][flwr][DEBUG] - fit_round 5 received 9 results and 0 failures
[2025-03-11 20:47:32,287][flwr][INFO] - fit progress: (5, 1.8537355661392212, {'accuracy': 0.3230000138282776}, 144.70718087500427)
[2025-03-11 20:47:32,288][flwr][DEBUG] - evaluate_round 5: strategy sampled 9 clients (out of 10)
[2025-03-11 20:47:34,188][flwr][DEBUG] - evaluate_round 5 received 9 results and 0 failures
[2025-03-11 20:47:36,996][flwr][INFO] - Server 6: selected clients
                ['9', '6', '3', '2', '5', '4', '1', '7', '0', '8'] for first phase evaluation.
[2025-03-11 20:47:36,996][flwr][DEBUG] - evaluate_first_phase 6: strategy sampled 10 clients (out of 10)
[2025-03-11 20:47:37,127][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:47:37,136][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:47:38,776][flwr][DEBUG] - evaluate_first_phase of round 6 received 9 results and 1 failures
[2025-03-11 20:47:38,776][flwr][INFO] - Server 6: about to sample 9 clients
[2025-03-11 20:47:38,776][flwr][INFO] - Round 6: selected clients
            ['0', '9', '3', '7', '8', '1', '4', '2', '5'] for fit.
[2025-03-11 20:47:38,776][flwr][DEBUG] - fit_round 6: strategy sampled 9 clients (out of 10)
[2025-03-11 20:48:00,647][flwr][DEBUG] - fit_round 6 received 9 results and 0 failures
[2025-03-11 20:48:01,706][flwr][INFO] - fit progress: (6, 1.828384518623352, {'accuracy': 0.30970001220703125}, 174.12603495805524)
[2025-03-11 20:48:01,706][flwr][DEBUG] - evaluate_round 6: strategy sampled 9 clients (out of 10)
[2025-03-11 20:48:03,595][flwr][DEBUG] - evaluate_round 6 received 9 results and 0 failures
[2025-03-11 20:48:06,415][flwr][INFO] - Server 7: selected clients
                ['3', '4', '7', '1', '5', '2', '0', '9', '6', '8'] for first phase evaluation.
[2025-03-11 20:48:06,415][flwr][DEBUG] - evaluate_first_phase 7: strategy sampled 10 clients (out of 10)
[2025-03-11 20:48:06,681][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:48:06,687][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:48:08,136][flwr][DEBUG] - evaluate_first_phase of round 7 received 9 results and 1 failures
[2025-03-11 20:48:08,136][flwr][INFO] - Server 7: about to sample 9 clients
[2025-03-11 20:48:08,136][flwr][INFO] - Round 7: selected clients
            ['2', '0', '4', '1', '3', '7', '5', '8', '9'] for fit.
[2025-03-11 20:48:08,137][flwr][DEBUG] - fit_round 7: strategy sampled 9 clients (out of 10)
[2025-03-11 20:48:30,089][flwr][DEBUG] - fit_round 7 received 9 results and 0 failures
[2025-03-11 20:48:31,139][flwr][INFO] - fit progress: (7, 1.7381705045700073, {'accuracy': 0.3564000129699707}, 203.5594205830712)
[2025-03-11 20:48:31,140][flwr][DEBUG] - evaluate_round 7: strategy sampled 9 clients (out of 10)
[2025-03-11 20:48:32,998][flwr][DEBUG] - evaluate_round 7 received 9 results and 0 failures
[2025-03-11 20:48:35,805][flwr][INFO] - Server 8: selected clients
                ['4', '2', '8', '6', '1', '0', '3', '7', '5', '9'] for first phase evaluation.
[2025-03-11 20:48:35,805][flwr][DEBUG] - evaluate_first_phase 8: strategy sampled 10 clients (out of 10)
[2025-03-11 20:48:35,921][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:48:35,924][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:48:37,558][flwr][DEBUG] - evaluate_first_phase of round 8 received 9 results and 1 failures
[2025-03-11 20:48:37,558][flwr][INFO] - Server 8: about to sample 9 clients
[2025-03-11 20:48:37,558][flwr][INFO] - Round 8: selected clients
            ['2', '0', '5', '1', '8', '7', '3', '4', '9'] for fit.
[2025-03-11 20:48:37,558][flwr][DEBUG] - fit_round 8: strategy sampled 9 clients (out of 10)
[2025-03-11 20:48:59,272][flwr][DEBUG] - fit_round 8 received 9 results and 0 failures
[2025-03-11 20:49:00,299][flwr][INFO] - fit progress: (8, 1.70914626121521, {'accuracy': 0.34940001368522644}, 232.78006604104303)
[2025-03-11 20:49:00,299][flwr][DEBUG] - evaluate_round 8: strategy sampled 9 clients (out of 10)
[2025-03-11 20:49:02,166][flwr][DEBUG] - evaluate_round 8 received 9 results and 0 failures
[2025-03-11 20:49:04,963][flwr][INFO] - Server 9: selected clients
                ['3', '2', '9', '4', '1', '6', '5', '8', '0', '7'] for first phase evaluation.
[2025-03-11 20:49:04,963][flwr][DEBUG] - evaluate_first_phase 9: strategy sampled 10 clients (out of 10)
[2025-03-11 20:49:05,118][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:49:05,122][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:49:06,699][flwr][DEBUG] - evaluate_first_phase of round 9 received 9 results and 1 failures
[2025-03-11 20:49:06,700][flwr][INFO] - Server 9: about to sample 9 clients
[2025-03-11 20:49:06,700][flwr][INFO] - Round 9: selected clients
            ['5', '0', '8', '2', '3', '9', '4', '7', '1'] for fit.
[2025-03-11 20:49:06,700][flwr][DEBUG] - fit_round 9: strategy sampled 9 clients (out of 10)
[2025-03-11 20:49:28,351][flwr][DEBUG] - fit_round 9 received 9 results and 0 failures
[2025-03-11 20:49:29,369][flwr][INFO] - fit progress: (9, 1.8034135103225708, {'accuracy': 0.3325999975204468}, 261.8515247909818)
[2025-03-11 20:49:29,370][flwr][DEBUG] - evaluate_round 9: strategy sampled 9 clients (out of 10)
[2025-03-11 20:49:31,179][flwr][DEBUG] - evaluate_round 9 received 9 results and 0 failures
[2025-03-11 20:49:33,956][flwr][INFO] - Server 10: selected clients
                ['8', '0', '7', '1', '6', '2', '9', '4', '3', '5'] for first phase evaluation.
[2025-03-11 20:49:33,956][flwr][DEBUG] - evaluate_first_phase 10: strategy sampled 10 clients (out of 10)
[2025-03-11 20:49:34,232][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:49:34,234][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:49:35,718][flwr][DEBUG] - evaluate_first_phase of round 10 received 9 results and 1 failures
[2025-03-11 20:49:35,719][flwr][INFO] - Server 10: about to sample 9 clients
[2025-03-11 20:49:35,719][flwr][INFO] - Round 10: selected clients
            ['7', '2', '5', '8', '4', '0', '3', '1', '9'] for fit.
[2025-03-11 20:49:35,719][flwr][DEBUG] - fit_round 10: strategy sampled 9 clients (out of 10)
[2025-03-11 20:49:57,555][flwr][DEBUG] - fit_round 10 received 9 results and 0 failures
[2025-03-11 20:49:58,579][flwr][INFO] - fit progress: (10, 1.6996278762817383, {'accuracy': 0.36149999499320984}, 291.0611313750269)
[2025-03-11 20:49:58,579][flwr][DEBUG] - evaluate_round 10: strategy sampled 9 clients (out of 10)
[2025-03-11 20:50:00,432][flwr][DEBUG] - evaluate_round 10 received 9 results and 0 failures
[2025-03-11 20:50:03,225][flwr][INFO] - Server 11: selected clients
                ['9', '8', '2', '0', '3', '5', '1', '7', '4', '6'] for first phase evaluation.
[2025-03-11 20:50:03,225][flwr][DEBUG] - evaluate_first_phase 11: strategy sampled 10 clients (out of 10)
[2025-03-11 20:50:03,437][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:50:03,439][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28738, ip=127.0.0.1, actor_id=0d270c4079c56aaaa25df7bd01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x141f80ac0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:50:04,969][flwr][DEBUG] - evaluate_first_phase of round 11 received 9 results and 1 failures
[2025-03-11 20:50:04,970][flwr][INFO] - Server 11: about to sample 9 clients
[2025-03-11 20:50:04,970][flwr][INFO] - Round 11: selected clients
            ['7', '4', '8', '0', '5', '2', '1', '9', '3'] for fit.
[2025-03-11 20:50:04,970][flwr][DEBUG] - fit_round 11: strategy sampled 9 clients (out of 10)
[2025-03-11 20:50:26,856][flwr][DEBUG] - fit_round 11 received 9 results and 0 failures
[2025-03-11 20:50:27,874][flwr][INFO] - fit progress: (11, 1.79417085647583, {'accuracy': 0.32170000672340393}, 320.3574929580791)
[2025-03-11 20:50:27,875][flwr][DEBUG] - evaluate_round 11: strategy sampled 9 clients (out of 10)
[2025-03-11 20:50:29,841][flwr][DEBUG] - evaluate_round 11 received 9 results and 0 failures
[2025-03-11 20:50:32,597][flwr][INFO] - Server 12: selected clients
                ['3', '5', '2', '0', '1', '9', '4', '7', '6', '8'] for first phase evaluation.
[2025-03-11 20:50:32,597][flwr][DEBUG] - evaluate_first_phase 12: strategy sampled 10 clients (out of 10)
[2025-03-11 20:50:32,803][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:50:32,805][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:50:34,293][flwr][DEBUG] - evaluate_first_phase of round 12 received 9 results and 1 failures
[2025-03-11 20:50:34,293][flwr][INFO] - Server 12: about to sample 9 clients
[2025-03-11 20:50:34,293][flwr][INFO] - Round 12: selected clients
            ['7', '5', '9', '4', '0', '8', '2', '3', '1'] for fit.
[2025-03-11 20:50:34,293][flwr][DEBUG] - fit_round 12: strategy sampled 9 clients (out of 10)
[2025-03-11 20:50:56,086][flwr][DEBUG] - fit_round 12 received 9 results and 0 failures
[2025-03-11 20:50:57,112][flwr][INFO] - fit progress: (12, 1.6973344087600708, {'accuracy': 0.35580000281333923}, 349.5956281659892)
[2025-03-11 20:50:57,112][flwr][DEBUG] - evaluate_round 12: strategy sampled 9 clients (out of 10)
[2025-03-11 20:50:58,919][flwr][DEBUG] - evaluate_round 12 received 9 results and 0 failures
[2025-03-11 20:51:01,654][flwr][INFO] - Server 13: selected clients
                ['0', '5', '2', '1', '9', '8', '3', '4', '7', '6'] for first phase evaluation.
[2025-03-11 20:51:01,654][flwr][DEBUG] - evaluate_first_phase 13: strategy sampled 10 clients (out of 10)
[2025-03-11 20:51:01,863][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:51:01,865][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:51:03,581][flwr][DEBUG] - evaluate_first_phase of round 13 received 9 results and 1 failures
[2025-03-11 20:51:03,582][flwr][INFO] - Server 13: about to sample 9 clients
[2025-03-11 20:51:03,582][flwr][INFO] - Round 13: selected clients
            ['2', '9', '1', '5', '4', '0', '3', '8', '7'] for fit.
[2025-03-11 20:51:03,582][flwr][DEBUG] - fit_round 13: strategy sampled 9 clients (out of 10)
[2025-03-11 20:51:25,664][flwr][DEBUG] - fit_round 13 received 9 results and 0 failures
[2025-03-11 20:51:26,686][flwr][INFO] - fit progress: (13, 1.7002341747283936, {'accuracy': 0.37470000982284546}, 379.16976416599937)
[2025-03-11 20:51:26,686][flwr][DEBUG] - evaluate_round 13: strategy sampled 9 clients (out of 10)
[2025-03-11 20:51:28,511][flwr][DEBUG] - evaluate_round 13 received 9 results and 0 failures
[2025-03-11 20:51:31,255][flwr][INFO] - Server 14: selected clients
                ['1', '8', '3', '9', '7', '4', '0', '2', '5', '6'] for first phase evaluation.
[2025-03-11 20:51:31,255][flwr][DEBUG] - evaluate_first_phase 14: strategy sampled 10 clients (out of 10)
[2025-03-11 20:51:31,601][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:51:31,603][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28747, ip=127.0.0.1, actor_id=89246de6283b87f2f2282aab01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165d80b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:51:33,069][flwr][DEBUG] - evaluate_first_phase of round 14 received 9 results and 1 failures
[2025-03-11 20:51:33,069][flwr][INFO] - Server 14: about to sample 9 clients
[2025-03-11 20:51:33,069][flwr][INFO] - Round 14: selected clients
            ['8', '9', '4', '2', '3', '1', '0', '7', '5'] for fit.
[2025-03-11 20:51:33,069][flwr][DEBUG] - fit_round 14: strategy sampled 9 clients (out of 10)
[2025-03-11 20:51:55,074][flwr][DEBUG] - fit_round 14 received 9 results and 0 failures
[2025-03-11 20:51:56,136][flwr][INFO] - fit progress: (14, 1.6344548463821411, {'accuracy': 0.4034999907016754}, 408.62041500001214)
[2025-03-11 20:51:56,136][flwr][DEBUG] - evaluate_round 14: strategy sampled 9 clients (out of 10)
[2025-03-11 20:51:58,090][flwr][DEBUG] - evaluate_round 14 received 9 results and 0 failures
[2025-03-11 20:52:00,903][flwr][INFO] - Server 15: selected clients
                ['0', '2', '8', '6', '1', '4', '9', '5', '7', '3'] for first phase evaluation.
[2025-03-11 20:52:00,903][flwr][DEBUG] - evaluate_first_phase 15: strategy sampled 10 clients (out of 10)
[2025-03-11 20:52:01,047][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:52:01,049][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:52:02,656][flwr][DEBUG] - evaluate_first_phase of round 15 received 9 results and 1 failures
[2025-03-11 20:52:02,656][flwr][INFO] - Server 15: about to sample 9 clients
[2025-03-11 20:52:02,657][flwr][INFO] - Round 15: selected clients
            ['5', '2', '4', '0', '9', '7', '3', '1', '8'] for fit.
[2025-03-11 20:52:02,657][flwr][DEBUG] - fit_round 15: strategy sampled 9 clients (out of 10)
[2025-03-11 20:52:24,896][flwr][DEBUG] - fit_round 15 received 9 results and 0 failures
[2025-03-11 20:52:26,008][flwr][INFO] - fit progress: (15, 1.5823016166687012, {'accuracy': 0.39820000529289246}, 438.49285154102836)
[2025-03-11 20:52:26,008][flwr][DEBUG] - evaluate_round 15: strategy sampled 9 clients (out of 10)
[2025-03-11 20:52:27,926][flwr][DEBUG] - evaluate_round 15 received 9 results and 0 failures
[2025-03-11 20:52:30,746][flwr][INFO] - Server 16: selected clients
                ['9', '8', '6', '3', '4', '0', '2', '5', '7', '1'] for first phase evaluation.
[2025-03-11 20:52:30,746][flwr][DEBUG] - evaluate_first_phase 16: strategy sampled 10 clients (out of 10)
[2025-03-11 20:52:30,902][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28748, ip=127.0.0.1, actor_id=a001352c95ac79210a37c58501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x136e80af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28748, ip=127.0.0.1, actor_id=a001352c95ac79210a37c58501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x136e80af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:52:30,905][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28748, ip=127.0.0.1, actor_id=a001352c95ac79210a37c58501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x136e80af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28748, ip=127.0.0.1, actor_id=a001352c95ac79210a37c58501000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x136e80af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:52:32,522][flwr][DEBUG] - evaluate_first_phase of round 16 received 9 results and 1 failures
[2025-03-11 20:52:32,522][flwr][INFO] - Server 16: about to sample 9 clients
[2025-03-11 20:52:32,522][flwr][INFO] - Round 16: selected clients
            ['2', '0', '1', '8', '7', '5', '4', '3', '9'] for fit.
[2025-03-11 20:52:32,522][flwr][DEBUG] - fit_round 16: strategy sampled 9 clients (out of 10)
[2025-03-11 20:52:54,613][flwr][DEBUG] - fit_round 16 received 9 results and 0 failures
[2025-03-11 20:52:55,667][flwr][INFO] - fit progress: (16, 1.8687171936035156, {'accuracy': 0.31060001254081726}, 468.15227566601243)
[2025-03-11 20:52:55,667][flwr][DEBUG] - evaluate_round 16: strategy sampled 9 clients (out of 10)
[2025-03-11 20:52:57,565][flwr][DEBUG] - evaluate_round 16 received 9 results and 0 failures
[2025-03-11 20:53:00,323][flwr][INFO] - Server 17: selected clients
                ['7', '8', '6', '9', '5', '2', '3', '0', '4', '1'] for first phase evaluation.
[2025-03-11 20:53:00,323][flwr][DEBUG] - evaluate_first_phase 17: strategy sampled 10 clients (out of 10)
[2025-03-11 20:53:00,475][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:53:00,477][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28743, ip=127.0.0.1, actor_id=084215e1a85c653f561502cc01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x13a780b80>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:53:02,109][flwr][DEBUG] - evaluate_first_phase of round 17 received 9 results and 1 failures
[2025-03-11 20:53:02,111][flwr][INFO] - Server 17: about to sample 9 clients
[2025-03-11 20:53:02,111][flwr][INFO] - Round 17: selected clients
            ['5', '2', '9', '7', '8', '1', '3', '0', '4'] for fit.
[2025-03-11 20:53:02,111][flwr][DEBUG] - fit_round 17: strategy sampled 9 clients (out of 10)
[2025-03-11 20:53:24,334][flwr][DEBUG] - fit_round 17 received 9 results and 0 failures
[2025-03-11 20:53:25,386][flwr][INFO] - fit progress: (17, 1.575457215309143, {'accuracy': 0.41029998660087585}, 497.8724193330854)
[2025-03-11 20:53:25,386][flwr][DEBUG] - evaluate_round 17: strategy sampled 9 clients (out of 10)
[2025-03-11 20:53:27,387][flwr][DEBUG] - evaluate_round 17 received 9 results and 0 failures
[2025-03-11 20:53:30,141][flwr][INFO] - Server 18: selected clients
                ['5', '8', '3', '0', '1', '2', '6', '9', '7', '4'] for first phase evaluation.
[2025-03-11 20:53:30,141][flwr][DEBUG] - evaluate_first_phase 18: strategy sampled 10 clients (out of 10)
[2025-03-11 20:53:30,411][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:53:30,413][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:53:31,851][flwr][DEBUG] - evaluate_first_phase of round 18 received 9 results and 1 failures
[2025-03-11 20:53:31,851][flwr][INFO] - Server 18: about to sample 9 clients
[2025-03-11 20:53:31,851][flwr][INFO] - Round 18: selected clients
            ['7', '9', '5', '8', '2', '1', '4', '3', '0'] for fit.
[2025-03-11 20:53:31,851][flwr][DEBUG] - fit_round 18: strategy sampled 9 clients (out of 10)
[2025-03-11 20:53:53,975][flwr][DEBUG] - fit_round 18 received 9 results and 0 failures
[2025-03-11 20:53:55,058][flwr][INFO] - fit progress: (18, 1.964417815208435, {'accuracy': 0.3107999861240387}, 527.5448186660651)
[2025-03-11 20:53:55,058][flwr][DEBUG] - evaluate_round 18: strategy sampled 9 clients (out of 10)
[2025-03-11 20:53:57,069][flwr][DEBUG] - evaluate_round 18 received 9 results and 0 failures
[2025-03-11 20:53:59,800][flwr][INFO] - Server 19: selected clients
                ['8', '9', '6', '7', '0', '2', '5', '4', '3', '1'] for first phase evaluation.
[2025-03-11 20:53:59,800][flwr][DEBUG] - evaluate_first_phase 19: strategy sampled 10 clients (out of 10)
[2025-03-11 20:54:00,002][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28745, ip=127.0.0.1, actor_id=a4e3157a24648915b75ec11c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161c7cb50>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28745, ip=127.0.0.1, actor_id=a4e3157a24648915b75ec11c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161c7cb50>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:54:00,016][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28745, ip=127.0.0.1, actor_id=a4e3157a24648915b75ec11c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161c7cb50>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28745, ip=127.0.0.1, actor_id=a4e3157a24648915b75ec11c01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x161c7cb50>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:54:01,772][flwr][DEBUG] - evaluate_first_phase of round 19 received 9 results and 1 failures
[2025-03-11 20:54:01,772][flwr][INFO] - Server 19: about to sample 9 clients
[2025-03-11 20:54:01,772][flwr][INFO] - Round 19: selected clients
            ['1', '4', '3', '2', '5', '0', '9', '7', '8'] for fit.
[2025-03-11 20:54:01,772][flwr][DEBUG] - fit_round 19: strategy sampled 9 clients (out of 10)
[2025-03-11 20:54:23,701][flwr][DEBUG] - fit_round 19 received 9 results and 0 failures
[2025-03-11 20:54:24,755][flwr][INFO] - fit progress: (19, 1.6114925146102905, {'accuracy': 0.3921999931335449}, 557.2426031660289)
[2025-03-11 20:54:24,756][flwr][DEBUG] - evaluate_round 19: strategy sampled 9 clients (out of 10)
[2025-03-11 20:54:26,670][flwr][DEBUG] - evaluate_round 19 received 9 results and 0 failures
[2025-03-11 20:54:29,504][flwr][INFO] - Server 20: selected clients
                ['9', '4', '3', '5', '7', '6', '2', '1', '0', '8'] for first phase evaluation.
[2025-03-11 20:54:29,504][flwr][DEBUG] - evaluate_first_phase 20: strategy sampled 10 clients (out of 10)
[2025-03-11 20:54:29,645][flwr][ERROR] - Traceback (most recent call last):
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 140, in _submit_job
    res = self.actor_pool.get_client_result(self.cid, timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 402, in get_client_result
    return self._fetch_future_result(cid)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 288, in _fetch_future_result
    res_cid, res = ray.get(future)  # type: (str, ClientRes)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientException): [36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)

[2025-03-11 20:54:29,649][flwr][ERROR] - [36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate
    return maybe_call_evaluate(
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate
    idx = np.random.choice(len(x_entire), b, replace=False)
  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice
ValueError: Cannot take a larger sample than population when 'replace=False'

The above exception was the direct cause of the following exception:

[36mray::DefaultActor.run()[39m (pid=28746, ip=127.0.0.1, actor_id=47873339209e037513bf2f7f01000000, repr=<flwr.simulation.ray_transport.ray_actor.DefaultActor object at 0x165180af0>)
  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 72, in run
    raise ClientException(str(message)) from ex
flwr.simulation.ray_transport.ray_actor.ClientException: 
>>>>>>>A ClientException occurred.('\n\tSomething went wrong when running your client workload.\n\tClient 6 crashed when the DefaultActor was running its workload.\n\tException triggered on the client side: Traceback (most recent call last):\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 60, in run\n    job_results = job_fn()\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 215, in evaluate\n    return maybe_call_evaluate(\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/client.py", line 237, in maybe_call_evaluate\n    return client.evaluate(evaluate_ins)\n  File "/opt/anaconda3/envs/NodeSelection/lib/python3.10/site-packages/flwr/client/app.py", line 357, in _evaluate\n    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore\n  File "/Users/livialestingi/PycharmProjects/NodeSelection/power_of_choice/power_of_choice/client_uo.py", line 90, in evaluate\n    idx = np.random.choice(len(x_entire), b, replace=False)\n  File "mtrand.pyx", line 984, in numpy.random.mtrand.RandomState.choice\nValueError: Cannot take a larger sample than population when \'replace=False\'\n',)
[2025-03-11 20:54:31,242][flwr][DEBUG] - evaluate_first_phase of round 20 received 9 results and 1 failures
[2025-03-11 20:54:31,243][flwr][INFO] - Server 20: about to sample 9 clients
[2025-03-11 20:54:31,243][flwr][INFO] - Round 20: selected clients
            ['2', '1', '0', '8', '4', '3', '5', '7', '9'] for fit.
[2025-03-11 20:54:31,243][flwr][DEBUG] - fit_round 20: strategy sampled 9 clients (out of 10)
[2025-03-11 20:54:53,246][flwr][DEBUG] - fit_round 20 received 9 results and 0 failures
[2025-03-11 20:54:54,275][flwr][INFO] - fit progress: (20, 1.5820976495742798, {'accuracy': 0.40400001406669617}, 586.7625039999839)
[2025-03-11 20:54:54,275][flwr][DEBUG] - evaluate_round 20: strategy sampled 9 clients (out of 10)
[2025-03-11 20:54:56,151][flwr][DEBUG] - evaluate_round 20 received 9 results and 0 failures
[2025-03-11 20:54:56,152][flwr][INFO] - FL finished in 588.6393027909799
[2025-03-11 20:54:56,152][flwr][INFO] - app_fit: losses_distributed [(1, 2.3162790839664473), (2, 2.3101009219027935), (3, 2.2101117939042587), (4, 2.0089940470628465), (5, 1.8463539795372814), (6, 1.8024862383882079), (7, 1.7269479945159187), (8, 1.7025490012793496), (9, 1.7557156170709445), (10, 1.6755505931167938), (11, 1.7749823446567066), (12, 1.659719161855908), (13, 1.6678489451400769), (14, 1.6116814639050359), (15, 1.5666630081475352), (16, 1.8542459598078895), (17, 1.547604588369211), (18, 1.8890258501322506), (19, 1.594542909544497), (20, 1.5271874936148762)]
[2025-03-11 20:54:56,152][flwr][INFO] - app_fit: metrics_distributed_fit {'variance_training_loss': [(1, 0.33578373676833473), (2, 0.2738213496344236), (3, 0.2494180268830779), (4, 0.23604102687308867), (5, 0.2238529925111055), (6, 0.21399342856984654), (7, 0.20376668363211484), (8, 0.2037850008153322), (9, 0.20253558566656038), (10, 0.19172231831731856), (11, 0.1924375794218766), (12, 0.19280518676349748), (13, 0.1905882132529712), (14, 0.1924071652446745), (15, 0.18757661800512274), (16, 0.1843987530793154), (17, 0.1809896369180977), (18, 0.1834847481804285), (19, 0.1794905958791141), (20, 0.17949684833898172)], 'average_training_loss': [(1, 1.245360794166724), (2, 1.1496863344477282), (3, 1.0972048752009869), (4, 1.056026844928662), (5, 1.031152365108331), (6, 1.0062140847245853), (7, 0.9832047774559922), (8, 0.9756788474818071), (9, 0.960913994246059), (10, 0.9468643524580531), (11, 0.9318065953751405), (12, 0.9236244335770607), (13, 0.9138817675411701), (14, 0.9067354835569859), (15, 0.8915770695441299), (16, 0.8872975558042526), (17, 0.872686955663893), (18, 0.8649041983816359), (19, 0.8551832309199704), (20, 0.853058254553212)], 'estimated_times': [(1, [17.36388968793728, 5.215053002217782, 13.176993293439535, 16.76823933055109, 32.55056494845947, 4.036654823085472, 7.897141399502468, 3.6720278046722337, 3.5600218341667533]), (2, [3.5600218341667533, 17.36388968793728, 16.76823933055109, 13.176993293439535, 5.215053002217782, 4.036654823085472, 7.897141399502468, 3.6720278046722337, 32.55056494845947]), (3, [17.36388968793728, 7.897141399502468, 32.55056494845947, 13.176993293439535, 16.76823933055109, 5.215053002217782, 4.036654823085472, 3.5600218341667533, 3.6720278046722337]), (4, [4.036654823085472, 16.76823933055109, 7.897141399502468, 5.215053002217782, 3.6720278046722337, 32.55056494845947, 3.5600218341667533, 13.176993293439535, 17.36388968793728]), (5, [3.5600218341667533, 5.215053002217782, 3.6720278046722337, 13.176993293439535, 32.55056494845947, 7.897141399502468, 16.76823933055109, 17.36388968793728, 4.036654823085472]), (6, [13.176993293439535, 3.5600218341667533, 32.55056494845947, 4.036654823085472, 16.76823933055109, 3.6720278046722337, 17.36388968793728, 7.897141399502468, 5.215053002217782]), (7, [7.897141399502468, 3.6720278046722337, 16.76823933055109, 4.036654823085472, 17.36388968793728, 5.215053002217782, 13.176993293439535, 3.5600218341667533, 32.55056494845947]), (8, [13.176993293439535, 16.76823933055109, 3.5600218341667533, 17.36388968793728, 32.55056494845947, 3.6720278046722337, 7.897141399502468, 4.036654823085472, 5.215053002217782]), (9, [32.55056494845947, 13.176993293439535, 16.76823933055109, 4.036654823085472, 5.215053002217782, 3.5600218341667533, 3.6720278046722337, 17.36388968793728, 7.897141399502468]), (10, [32.55056494845947, 7.897141399502468, 13.176993293439535, 4.036654823085472, 5.215053002217782, 3.6720278046722337, 3.5600218341667533, 17.36388968793728, 16.76823933055109]), (11, [3.5600218341667533, 7.897141399502468, 16.76823933055109, 3.6720278046722337, 4.036654823085472, 32.55056494845947, 13.176993293439535, 17.36388968793728, 5.215053002217782]), (12, [17.36388968793728, 7.897141399502468, 3.6720278046722337, 32.55056494845947, 16.76823933055109, 4.036654823085472, 5.215053002217782, 3.5600218341667533, 13.176993293439535]), (13, [17.36388968793728, 3.6720278046722337, 5.215053002217782, 16.76823933055109, 32.55056494845947, 3.5600218341667533, 13.176993293439535, 7.897141399502468, 4.036654823085472]), (14, [3.5600218341667533, 16.76823933055109, 7.897141399502468, 32.55056494845947, 5.215053002217782, 13.176993293439535, 3.6720278046722337, 4.036654823085472, 17.36388968793728]), (15, [4.036654823085472, 32.55056494845947, 13.176993293439535, 16.76823933055109, 3.6720278046722337, 3.5600218341667533, 5.215053002217782, 17.36388968793728, 7.897141399502468]), (16, [3.5600218341667533, 13.176993293439535, 5.215053002217782, 3.6720278046722337, 32.55056494845947, 16.76823933055109, 4.036654823085472, 17.36388968793728, 7.897141399502468]), (17, [17.36388968793728, 5.215053002217782, 4.036654823085472, 32.55056494845947, 3.6720278046722337, 3.5600218341667533, 16.76823933055109, 7.897141399502468, 13.176993293439535]), (18, [3.6720278046722337, 13.176993293439535, 7.897141399502468, 16.76823933055109, 5.215053002217782, 4.036654823085472, 32.55056494845947, 3.5600218341667533, 17.36388968793728]), (19, [5.215053002217782, 16.76823933055109, 3.5600218341667533, 13.176993293439535, 3.6720278046722337, 17.36388968793728, 32.55056494845947, 7.897141399502468, 4.036654823085472]), (20, [17.36388968793728, 3.6720278046722337, 32.55056494845947, 4.036654823085472, 16.76823933055109, 3.5600218341667533, 5.215053002217782, 7.897141399502468, 13.176993293439535])]}
[2025-03-11 20:54:56,154][flwr][INFO] - app_fit: metrics_distributed {}
[2025-03-11 20:54:56,154][flwr][INFO] - app_fit: losses_centralized [(0, 2.3038480281829834), (1, 2.3129842281341553), (2, 2.303515911102295), (3, 2.200575351715088), (4, 2.020131826400757), (5, 1.8537355661392212), (6, 1.828384518623352), (7, 1.7381705045700073), (8, 1.70914626121521), (9, 1.8034135103225708), (10, 1.6996278762817383), (11, 1.79417085647583), (12, 1.6973344087600708), (13, 1.7002341747283936), (14, 1.6344548463821411), (15, 1.5823016166687012), (16, 1.8687171936035156), (17, 1.575457215309143), (18, 1.964417815208435), (19, 1.6114925146102905), (20, 1.5820976495742798)]
[2025-03-11 20:54:56,154][flwr][INFO] - app_fit: metrics_centralized {'accuracy': [(0, 0.10000000149011612), (1, 0.10000000149011612), (2, 0.10830000042915344), (3, 0.1680999994277954), (4, 0.2386000007390976), (5, 0.3230000138282776), (6, 0.30970001220703125), (7, 0.3564000129699707), (8, 0.34940001368522644), (9, 0.3325999975204468), (10, 0.36149999499320984), (11, 0.32170000672340393), (12, 0.35580000281333923), (13, 0.37470000982284546), (14, 0.4034999907016754), (15, 0.39820000529289246), (16, 0.31060001254081726), (17, 0.41029998660087585), (18, 0.3107999861240387), (19, 0.3921999931335449), (20, 0.40400001406669617)]}
